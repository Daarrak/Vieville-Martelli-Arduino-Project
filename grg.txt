//Libraries
#include <Pixy2.h>

//Variables
Pixy2 pixy;
int buzzer=11;
int trig=2;
int echo=8;
float lecture_echo;

// MOTEUR A
int ENA=9; // 9 pour sortie PWM
int IN1=4;
int IN2=5;

// MOTEUR B
int ENB=10; // 10 pour sortie PWM
int IN3=6;
int IN4=7;


void setup() {
 	Serial.begin(19200);
 	pixy.init();
  pinMode(buzzer,OUTPUT);
  pinMode(trig,OUTPUT);
  pinMode(echo,INPUT);
  pinMode(ENA,OUTPUT);
  pinMode(ENB,OUTPUT);
  pinMode(IN1,OUTPUT);
  pinMode(IN2,OUTPUT);  
  pinMode(IN3,OUTPUT);
  pinMode(IN4,OUTPUT);

// Direction du Moteur droit
  digitalWrite(IN1,HIGH);  
  digitalWrite(IN2,LOW);

// Direction du Moteur gauche
  digitalWrite(IN3,HIGH);
  digitalWrite(IN4,LOW);

// Met les 2 moteurs à l'arrêt
  digitalWrite(ENA,0);
  digitalWrite(ENB,0);
  noTone(buzzer);
}

void loop() {
  noTone(buzzer);
  digitalWrite(trig,1);
  delayMicroseconds(10);
  digitalWrite(trig,0);
  lecture_echo=pulseIn(echo, 1)*0.017;
  Serial.println(lecture_echo);
  if(lecture_echo<20) stop();
  else forward();
}
 	

void stop(){
  digitalWrite(ENA,0);
  digitalWrite(ENB,0);
}

void forward(){

  digitalWrite(ENA,90);
  digitalWrite(ENB,90);
}

void turnRight(){

  digitalWrite(ENA,0);
  digitalWrite(ENB,90);
}

void turnLeft(){

  digitalWrite(ENA,90);
  digitalWrite(ENB,0);
}